addons:
- exclude:
    jobs:
    - name: smoke_tests
      release: cf-smoke-tests
  include:
    stemcell:
    - os: ubuntu-xenial
    - os: ubuntu-bionic
  jobs:
  - name: loggregator_agent
    properties:
      disable_udp: true
      grpc_port: 3459
      loggregator:
        tls:
          agent:
            cert: <!{credhub}:loggregator_tls_agent.certificate!>
            key: <!{credhub}:loggregator_tls_agent.private_key!>
          ca_cert: <!{credhub}:loggregator_tls_agent.ca!>
      metrics:
        ca_cert: <!{credhub}:loggregator_agent_metrics_tls.ca!>
        cert: <!{credhub}:loggregator_agent_metrics_tls.certificate!>
        key: <!{credhub}:loggregator_agent_metrics_tls.private_key!>
        server_name: loggregator_agent_metrics
    release: loggregator-agent
  name: loggregator_agent
- include:
    stemcell:
    - os: ubuntu-xenial
    - os: ubuntu-bionic
  jobs:
  - name: loggr-forwarder-agent
    properties:
      metrics:
        ca_cert: <!{credhub}:forwarder_agent_metrics_tls.ca!>
        cert: <!{credhub}:forwarder_agent_metrics_tls.certificate!>
        key: <!{credhub}:forwarder_agent_metrics_tls.private_key!>
        server_name: forwarder_agent_metrics
      tls:
        ca_cert: <!{credhub}:loggregator_tls_agent.ca!>
        cert: <!{credhub}:loggregator_tls_agent.certificate!>
        key: <!{credhub}:loggregator_tls_agent.private_key!>
    release: loggregator-agent
  name: forwarder_agent
- exclude:
    jobs:
    - name: smoke_tests
      release: cf-smoke-tests
  include:
    stemcell:
    - os: ubuntu-xenial
    - os: ubuntu-bionic
  jobs:
  - name: loggr-syslog-agent
    properties:
      cache:
        tls:
          ca_cert: <!{credhub}:syslog_agent_api_tls.ca!>
          cert: <!{credhub}:syslog_agent_api_tls.certificate!>
          cn: binding-cache
          key: <!{credhub}:syslog_agent_api_tls.private_key!>
      metrics:
        ca_cert: <!{credhub}:syslog_agent_metrics_tls.ca!>
        cert: <!{credhub}:syslog_agent_metrics_tls.certificate!>
        key: <!{credhub}:syslog_agent_metrics_tls.private_key!>
        server_name: syslog_agent_metrics
      port: 3460
      tls:
        ca_cert: <!{credhub}:loggregator_tls_agent.ca!>
        cert: <!{credhub}:loggregator_tls_agent.certificate!>
        key: <!{credhub}:loggregator_tls_agent.private_key!>
    release: loggregator-agent
  name: loggr-syslog-agent
- exclude:
    jobs:
    - name: smoke_tests
      release: cf-smoke-tests
  include:
    stemcell:
    - os: ubuntu-xenial
    - os: ubuntu-bionic
  jobs:
  - name: prom_scraper
    properties:
      metrics:
        ca_cert: <!{credhub}:prom_scraper_metrics_tls.ca!>
        cert: <!{credhub}:prom_scraper_metrics_tls.certificate!>
        key: <!{credhub}:prom_scraper_metrics_tls.private_key!>
        server_name: prom_scraper_metrics
      scrape:
        tls:
          ca_cert: <!{credhub}:prom_scraper_scrape_tls.ca!>
          cert: <!{credhub}:prom_scraper_scrape_tls.certificate!>
          key: <!{credhub}:prom_scraper_scrape_tls.private_key!>
      scrape_interval: 60s
    release: loggregator-agent
  name: prom_scraper
- exclude:
    jobs:
    - name: smoke_tests
      release: cf-smoke-tests
  include:
    stemcell:
    - os: ubuntu-xenial
    - os: ubuntu-bionic
  jobs:
  - name: metrics-discovery-registrar
    properties:
      metrics:
        ca_cert: <!{credhub}:metrics_discovery_metrics_tls.ca!>
        cert: <!{credhub}:metrics_discovery_metrics_tls.certificate!>
        key: <!{credhub}:metrics_discovery_metrics_tls.private_key!>
        server_name: metrics_discovery_metrics
      nats_client:
        cert: <!{credhub}:nats_client_cert.certificate!>
        key: <!{credhub}:nats_client_cert.private_key!>
    release: metrics-discovery
  name: metrics-discovery-registrar
- exclude:
    jobs:
    - name: smoke_tests
      release: cf-smoke-tests
  include:
    stemcell:
    - os: ubuntu-xenial
    - os: ubuntu-bionic
  jobs:
  - name: metrics-agent
    properties:
      grpc:
        ca_cert: <!{credhub}:loggregator_tls_agent.ca!>
        cert: <!{credhub}:loggregator_tls_agent.certificate!>
        key: <!{credhub}:loggregator_tls_agent.private_key!>
      metrics:
        ca_cert: <!{credhub}:metrics_agent_tls.ca!>
        cert: <!{credhub}:metrics_agent_tls.certificate!>
        key: <!{credhub}:metrics_agent_tls.private_key!>
        server_name: metrics_agent
      scrape:
        tls:
          ca_cert: <!{credhub}:prom_scraper_scrape_tls.ca!>
          cert: <!{credhub}:prom_scraper_scrape_tls.certificate!>
          key: <!{credhub}:prom_scraper_scrape_tls.private_key!>
    release: metrics-discovery
  name: metrics-agent
- include:
    stemcell:
    - os: ubuntu-xenial
    - os: ubuntu-bionic
  jobs:
  - name: bpm
    release: bpm
  name: bpm
- jobs:
  - name: bosh-dns-aliases
    properties:
      aliases:
      - domain: _.cell.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: diego-cell
          network: cf-runtime
          query: _
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: windows2012R2-cell
          network: cf-runtime
          query: _
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: windows2016-cell
          network: cf-runtime
          query: _
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: isolated-diego-cell
          network: cf-runtime
          query: _
      - domain: auctioneer.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: scheduler
          network: cf-core
          query: q-s4
      - domain: bbs.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: diego-api
          network: cf-core
          query: q-s4
      - domain: blobstore.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: singleton-blobstore
          network: cf-core
          query: '*'
      - domain: cc-uploader.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: api
          network: cf-core
          query: '*'
      - domain: cloud-controller-ng.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: api
          network: cf-core
          query: '*'
      - domain: credhub.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: credhub
          network: cf-core
          query: '*'
      - domain: doppler.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: doppler
          network: cf-core
          query: '*'
      - domain: file-server.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: api
          network: cf-core
          query: '*'
      - domain: gorouter.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: router
          network: cf-edge
          query: '*'
      - domain: locket.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: diego-api
          network: cf-core
          query: '*'
      - domain: loggregator-trafficcontroller.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: log-api
          network: cf-core
          query: '*'
      - domain: policy-server.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: api
          network: cf-core
          query: '*'
      - domain: reverse-log-proxy.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: log-api
          network: cf-core
          query: '*'
      - domain: routing-api.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: api
          network: cf-core
          query: '*'
      - domain: silk-controller.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: diego-api
          network: cf-core
          query: '*'
      - domain: sql-db.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: database
          network: cf-core
          query: '*'
      - domain: ssh-proxy.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: scheduler
          network: cf-core
          query: '*'
      - domain: tps.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: scheduler
          network: cf-core
          query: '*'
      - domain: uaa.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: uaa
          network: cf-core
          query: '*'
      - domain: nats.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: nats
          network: cf-core
          query: '*'
      - domain: _.nats.service.cf.internal
        targets:
        - deployment: compiled-windows-releases-cf
          domain: bosh
          instance_group: nats
          network: cf-core
          query: _
    release: bosh-dns-aliases
  name: bosh-dns-aliases
- include:
    stemcell:
    - os: windows2019
  jobs:
  - name: metrics-discovery-registrar-windows
    properties:
      metrics:
        ca_cert: <!{credhub}:metrics_discovery_metrics_tls.ca!>
        cert: <!{credhub}:metrics_discovery_metrics_tls.certificate!>
        key: <!{credhub}:metrics_discovery_metrics_tls.private_key!>
        server_name: metrics_discovery_metrics
      nats_client:
        cert: <!{credhub}:nats_client_cert.certificate!>
        key: <!{credhub}:nats_client_cert.private_key!>
    release: metrics-discovery
  - name: metrics-agent-windows
    properties:
      grpc:
        ca_cert: <!{credhub}:loggregator_tls_agent.ca!>
        cert: <!{credhub}:loggregator_tls_agent.certificate!>
        key: <!{credhub}:loggregator_tls_agent.private_key!>
      metrics:
        ca_cert: <!{credhub}:metrics_agent_tls.ca!>
        cert: <!{credhub}:metrics_agent_tls.certificate!>
        key: <!{credhub}:metrics_agent_tls.private_key!>
        server_name: metrics_agent
      scrape:
        tls:
          ca_cert: <!{credhub}:prom_scraper_scrape_tls.ca!>
          cert: <!{credhub}:prom_scraper_scrape_tls.certificate!>
          key: <!{credhub}:prom_scraper_scrape_tls.private_key!>
    release: metrics-discovery
  name: metrics-discovery-windows2019
exodus:
  admin_password: <!{credhub}:cf_admin_password!>
  admin_username: admin
  api_domain: api.system.cf.testing.examle
  app_domains:
  - run.cf.testing.examle
  apps_domain: run.cf.testing.examle
  base_domain: cf.testing.examle
  bosh: compiled-windows-releases
  cf-deployment-date: 2022-Feb-14 03:48:47 UTC
  cf-deployment-hotfixes: true
  cf-deployment-url: https://github.com/cloudfoundry/cf-deployment/releases/tag/v16.25.0
  cf-deployment-version: 16.25.0
  core_network: cf-core
  db_network: cf-core
  edge_network: cf-edge
  features: compiled-releases,windows-diego-cells,smb-volume-services
  is_director: false
  runtime_network: cf-runtime
  system_domain: system.cf.testing.examle
  system_org: system
  system_space: system
  use_create_env: false
  vaulted_uaa_clients: /secret/compiled/windows/releases/cf/uaa/client_secrets:firehose
features:
  randomize_az_placement: true
instance_groups:
- azs:
  - z1
  - z2
  instances: 1
  jobs:
  - name: smoke_tests
    properties:
      bpm:
        enabled: true
      smoke_tests:
        api: https://api.system.cf.testing.examle
        apps_domain: run.cf.testing.examle
        cf_dial_timeout_in_seconds: 300
        client: cf_smoke_tests
        client_secret: <!{credhub}:uaa_clients_cf_smoke_tests_secret!>
        org: cf_smoke_tests_org
        skip_ssl_validation: true
        space: cf_smoke_tests_space
    release: cf-smoke-tests
  - name: cf-cli-7-linux
    release: cf-cli
  lifecycle: errand
  name: smoke-tests
  networks:
  - name: cf-runtime
  stemcell: default
  vm_type: minimal
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - name: nats
    properties:
      nats:
        hostname: nats.service.cf.internal
        internal:
          tls:
            ca: <!{credhub}:nats_internal_cert.ca!>
            certificate: <!{credhub}:nats_internal_cert.certificate!>
            enabled: true
            private_key: <!{credhub}:nats_internal_cert.private_key!>
        password: <!{credhub}:nats_password!>
        user: nats
    provides:
      nats:
        as: nats
        shared: true
    release: nats
  - custom_provider_definitions:
    - name: nats-tls-address
      type: address
    name: nats-tls
    properties:
      nats:
        external:
          tls:
            ca: <!{credhub}:nats_client_cert.ca!>
            certificate: <!{credhub}:nats_server_cert.certificate!>
            private_key: <!{credhub}:nats_server_cert.private_key!>
        hostname: nats.service.cf.internal
        internal:
          tls:
            ca: <!{credhub}:nats_internal_cert.ca!>
            certificate: <!{credhub}:nats_internal_cert.certificate!>
            enabled: true
            private_key: <!{credhub}:nats_internal_cert.private_key!>
        password: <!{credhub}:nats_password!>
        user: nats
    provides:
      nats-tls:
        as: nats-tls
        shared: true
    release: nats
  name: nats
  networks:
  - name: cf-core
  stemcell: default
  vm_type: minimal
- azs:
  - z1
  instances: 1
  jobs:
  - name: postgres
    properties:
      databases:
        databases:
        - citext: true
          name: cloud_controller
          tag: cc
        - citext: true
          name: uaa
          tag: uaa
        - citext: true
          name: diego
          tag: diego
        - citext: true
          name: routing-api
          tag: routing-api
        - citext: false
          name: network_policy
          tag: networkpolicy
        - citext: false
          name: network_connectivity
          tag: networkconnectivity
        - citext: true
          name: locket
          tag: locket
        - citext: true
          name: credhub
          tag: credhub
        db_scheme: postgres
        port: 5524
        roles:
        - name: cloud_controller
          password: <!{credhub}:cc_database_password!>
          tag: admin
        - name: uaa
          password: <!{credhub}:uaa_database_password!>
          tag: admin
        - name: diego
          password: <!{credhub}:diego_database_password!>
          tag: admin
        - name: routing-api
          password: <!{credhub}:routing_api_database_password!>
          tag: admin
        - name: network_policy
          password: <!{credhub}:network_policy_database_password!>
          tag: admin
        - name: network_connectivity
          password: <!{credhub}:network_connectivity_database_password!>
          tag: admin
        - name: locket
          password: <!{credhub}:locket_database_password!>
          tag: locket
        - name: credhub
          password: <!{credhub}:credhub_database_password!>
          tag: admin
    release: postgres
  migrated_from:
  - name: postgres
  - name: singleton-database
  name: database
  networks:
  - name: cf-core
  persistent_disk_type: 10GB
  stemcell: default
  update:
    serial: true
  vm_type: small
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - name: cfdot
    properties:
      tls:
        ca_certificate: <!{credhub}:diego_rep_client.ca!>
        certificate: <!{credhub}:diego_rep_client.certificate!>
        private_key: <!{credhub}:diego_rep_client.private_key!>
    release: diego
  - name: bbs
    properties:
      bpm:
        enabled: true
      diego:
        bbs:
          active_key_label: key-2016-06
          auctioneer:
            ca_cert: <!{credhub}:diego_auctioneer_client.ca!>
            client_cert: <!{credhub}:diego_auctioneer_client.certificate!>
            client_key: <!{credhub}:diego_auctioneer_client.private_key!>
          ca_cert: <!{credhub}:diego_bbs_server.ca!>
          detect_consul_cell_registrations: false
          encryption_keys:
          - label: key-2016-06
            passphrase: <!{credhub}:diego_bbs_encryption_keys_passphrase!>
          rep:
            ca_cert: <!{credhub}:diego_rep_client.ca!>
            client_cert: <!{credhub}:diego_rep_client.certificate!>
            client_key: <!{credhub}:diego_rep_client.private_key!>
            require_tls: true
          server_cert: <!{credhub}:diego_bbs_server.certificate!>
          server_key: <!{credhub}:diego_bbs_server.private_key!>
          skip_consul_lock: true
          sql:
            db_driver: postgres
            db_host: sql-db.service.cf.internal
            db_password: <!{credhub}:diego_database_password!>
            db_port: 5524
            db_schema: diego
            db_username: diego
      enable_consul_service_registration: false
      logging:
        format:
          timestamp: rfc3339
      loggregator:
        ca_cert: <!{credhub}:loggregator_tls_agent.ca!>
        cert: <!{credhub}:loggregator_tls_agent.certificate!>
        key: <!{credhub}:loggregator_tls_agent.private_key!>
        use_v2_api: true
    release: diego
  - name: silk-controller
    properties:
      ca_cert: <!{credhub}:silk_controller.ca!>
      database:
        host: sql-db.service.cf.internal
        name: network_connectivity
        password: <!{credhub}:network_connectivity_database_password!>
        port: 5524
        type: postgres
        username: network_connectivity
      server_cert: <!{credhub}:silk_controller.certificate!>
      server_key: <!{credhub}:silk_controller.private_key!>
      silk_daemon:
        ca_cert: <!{credhub}:silk_daemon.ca!>
        client_cert: <!{credhub}:silk_daemon.certificate!>
        client_key: <!{credhub}:silk_daemon.private_key!>
    release: silk
  - name: locket
    properties:
      bpm:
        enabled: true
      diego:
        locket:
          sql:
            db_driver: postgres
            db_host: sql-db.service.cf.internal
            db_password: <!{credhub}:locket_database_password!>
            db_port: 5524
            db_schema: locket
            db_username: locket
      enable_consul_service_registration: false
      logging:
        format:
          timestamp: rfc3339
      loggregator:
        ca_cert: <!{credhub}:loggregator_tls_agent.ca!>
        cert: <!{credhub}:loggregator_tls_agent.certificate!>
        key: <!{credhub}:loggregator_tls_agent.private_key!>
        use_v2_api: true
      tls:
        ca_cert: <!{credhub}:diego_locket_server.ca!>
        cert: <!{credhub}:diego_locket_server.certificate!>
        key: <!{credhub}:diego_locket_server.private_key!>
    release: diego
  - name: loggr-udp-forwarder
    properties:
      loggregator:
        tls:
          ca: <!{credhub}:loggregator_tls_agent.ca!>
          cert: <!{credhub}:loggregator_tls_agent.certificate!>
          key: <!{credhub}:loggregator_tls_agent.private_key!>
      metrics:
        ca_cert: <!{credhub}:loggr_udp_forwarder_tls.ca!>
        cert: <!{credhub}:loggr_udp_forwarder_tls.certificate!>
        key: <!{credhub}:loggr_udp_forwarder_tls.private_key!>
        server_name: loggr_udp_forwarder_metrics
    release: loggregator-agent
  migrated_from:
  - name: diego-bbs
  name: diego-api
  networks:
  - name: cf-core
  stemcell: default
  vm_type: small
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - name: uaa
    properties:
      encryption:
        active_key_label: default_key
        encryption_keys:
        - label: default_key
          passphrase: <!{credhub}:uaa_default_encryption_passphrase!>
      login:
        branding:
          footer_legal_text: null
          footer_links: null
          product_logo: null
          square_logo: null
        links:
          passwd: https://login.system.cf.testing.examle/forgot_password
          signup: https://login.system.cf.testing.examle/create_account
        saml:
          activeKeyId: key-1
          keys:
            key-1:
              certificate: <!{credhub}:uaa_login_saml.certificate!>
              key: <!{credhub}:uaa_login_saml.private_key!>
              passphrase: ""
      uaa:
        admin:
          client_secret: <!{credhub}:uaa_admin_client_secret!>
        clients:
          cc-service-dashboards:
            authorities: clients.read,clients.write,clients.admin
            authorized-grant-types: client_credentials
            scope: openid,cloud_controller_service_permissions.read
            secret: <!{credhub}:uaa_clients_cc-service-dashboards_secret!>
          cc_routing:
            authorities: routing.router_groups.read
            authorized-grant-types: client_credentials
            secret: <!{credhub}:uaa_clients_cc-routing_secret!>
          cc_service_key_client:
            authorities: credhub.read,credhub.write
            authorized-grant-types: client_credentials
            secret: <!{credhub}:uaa_clients_cc_service_key_client_secret!>
          cf:
            access-token-validity: 1200
            authorities: uaa.none
            authorized-grant-types: password,refresh_token
            override: true
            refresh-token-validity: 2592000
            scope: network.admin,network.write,cloud_controller.read,cloud_controller.write,openid,password.write,cloud_controller.admin,scim.read,scim.write,doppler.firehose,uaa.user,routing.router_groups.read,routing.router_groups.write,cloud_controller.admin_read_only,cloud_controller.global_auditor,perm.admin,clients.read
            secret: ""
          cf_smoke_tests:
            authorities: cloud_controller.admin,clients.read
            authorized-grant-types: client_credentials
            secret: <!{credhub}:uaa_clients_cf_smoke_tests_secret!>
          cloud_controller_username_lookup:
            authorities: scim.userids
            authorized-grant-types: client_credentials
            secret: <!{credhub}:uaa_clients_cloud_controller_username_lookup_secret!>
          credhub_admin_client:
            authorities: credhub.read,credhub.write
            authorized-grant-types: client_credentials
            secret: <!{credhub}:credhub_admin_client_secret!>
          doppler:
            authorities: uaa.resource
            authorized-grant-types: client_credentials
            override: true
            secret: <!{credhub}:uaa_clients_doppler_secret!>
          gorouter:
            authorities: routing.routes.read
            authorized-grant-types: client_credentials
            secret: <!{credhub}:uaa_clients_gorouter_secret!>
          network-policy:
            authorities: uaa.resource,cloud_controller.admin_read_only
            authorized-grant-types: client_credentials
            secret: <!{credhub}:uaa_clients_network_policy_secret!>
          routing_api_client:
            authorities: routing.routes.write,routing.routes.read,routing.router_groups.read
            authorized-grant-types: client_credentials
            secret: <!{credhub}:uaa_clients_routing_api_client_secret!>
          smb-broker-client:
            authorities: cloud_controller.admin,clients.read
            authorized-grant-types: client_credentials
            secret: <!{credhub}:smb-broker-uaa-client-secret!>
          smb-broker-credhub-client:
            authorities: credhub.read,credhub.write
            authorized-grant-types: client_credentials
            secret: <!{credhub}:smb-broker-credhub-uaa-client-secret!>
          ssh-proxy:
            authorized-grant-types: authorization_code
            autoapprove: true
            override: true
            redirect-uri: https://uaa.system.cf.testing.examle/login
            scope: openid,cloud_controller.read,cloud_controller.write,cloud_controller.admin
            secret: <!{credhub}:uaa_clients_ssh-proxy_secret!>
          tcp_emitter:
            authorities: routing.routes.write,routing.routes.read
            authorized-grant-types: client_credentials
            secret: <!{credhub}:uaa_clients_tcp_emitter_secret!>
          tcp_router:
            authorities: routing.routes.read,routing.router_groups.read
            authorized-grant-types: client_credentials
            secret: <!{credhub}:uaa_clients_tcp_router_secret!>
        jwt:
          policy:
            active_key_id: key-1
            keys:
              key-1:
                signingKey: <!{credhub}:uaa_jwt_signing_key.private_key!>
        logging_level: INFO
        scim:
          users:
          - groups:
            - clients.read
            - cloud_controller.admin
            - doppler.firehose
            - network.admin
            - openid
            - routing.router_groups.read
            - routing.router_groups.write
            - scim.read
            - scim.write
            name: admin
            password: <!{credhub}:cf_admin_password!>
        sslCertificate: <!{credhub}:uaa_ssl.certificate!>
        sslPrivateKey: <!{credhub}:uaa_ssl.private_key!>
        url: https://uaa.system.cf.testing.examle
        zones:
          internal:
            hostnames:
            - uaa.service.cf.internal
      uaadb:
        databases:
        - name: uaa
          tag: uaa
        db_scheme: postgresql
        port: 5524
        roles:
        - name: uaa
          password: <!{credhub}:uaa_database_password!>
          tag: admin
        tls: disabled
    release: uaa
  - name: route_registrar
    properties:
      nats:
        tls:
          client_cert: <!{credhub}:nats_client_cert.certificate!>
          client_key: <!{credhub}:nats_client_cert.private_key!>
          enabled: true
      route_registrar:
        routes:
        - health_check:
            name: uaa-healthcheck
            script_path: /var/vcap/jobs/uaa/bin/dns/healthy
          name: uaa
          registration_interval: 10s
          server_cert_domain_san: uaa.service.cf.internal
          tags:
            component: uaa
          tls_port: 8443
          uris:
          - uaa.system.cf.testing.examle
          - '*.uaa.system.cf.testing.examle'
          - login.system.cf.testing.examle
          - '*.login.system.cf.testing.examle'
    release: routing
  - name: statsd_injector
    properties:
      loggregator:
        tls:
          ca_cert: <!{credhub}:loggregator_tls_statsdinjector.ca!>
          statsd_injector:
            cert: <!{credhub}:loggregator_tls_statsdinjector.certificate!>
            key: <!{credhub}:loggregator_tls_statsdinjector.private_key!>
    release: statsd-injector
  name: uaa
  networks:
  - name: cf-core
  stemcell: default
  vm_type: minimal
- azs:
  - z1
  instances: 1
  jobs:
  - name: blobstore
    properties:
      blobstore:
        admin_users:
        - password: <!{credhub}:blobstore_admin_users_password!>
          username: blobstore-user
        secure_link:
          secret: <!{credhub}:blobstore_secure_link_secret!>
        tls:
          cert: <!{credhub}:blobstore_tls.certificate!>
          private_key: <!{credhub}:blobstore_tls.private_key!>
      select_directories_to_backup:
      - buildpacks
      - packages
      - droplets
      system_domain: system.cf.testing.examle
    release: capi
  - name: route_registrar
    properties:
      nats:
        tls:
          client_cert: <!{credhub}:nats_client_cert.certificate!>
          client_key: <!{credhub}:nats_client_cert.private_key!>
          enabled: true
      route_registrar:
        routes:
        - name: blobstore
          port: 8080
          registration_interval: 20s
          tags:
            component: blobstore
          uris:
          - blobstore.system.cf.testing.examle
    release: routing
  migrated_from:
  - name: blobstore
  name: singleton-blobstore
  networks:
  - name: cf-core
  persistent_disk_type: 100GB
  stemcell: default
  update:
    serial: true
  vm_type: small
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - name: cloud_controller_ng
    properties:
      app_domains:
      - run.cf.testing.examle
      app_ssh:
        host_key_fingerprint: <!{credhub}:diego_ssh_proxy_host_key.public_key_fingerprint!>
      build: cf-genesis-kit v2.0.0
      cc:
        buildpacks:
          blobstore_type: webdav
          webdav_config:
            blobstore_timeout: 5
            ca_cert: <!{credhub}:blobstore_tls.ca!>
            password: <!{credhub}:blobstore_admin_users_password!>
            private_endpoint: https://blobstore.service.cf.internal:4443
            public_endpoint: https://blobstore.system.cf.testing.examle
            username: blobstore-user
        bulk_api_password: <!{credhub}:cc_bulk_api_password!>
        database_encryption:
          current_key_label: encryption_key_0
          keys:
            encryption_key_0: <!{credhub}:cc_db_encryption_key!>
        db_encryption_key: <!{credhub}:cc_db_encryption_key!>
        default_running_security_groups:
        - public_networks
        - dns
        default_staging_security_groups:
        - public_networks
        - dns
        diego:
          docker_staging_stack: cflinuxfs3
        droplets:
          blobstore_type: webdav
          webdav_config:
            blobstore_timeout: 5
            ca_cert: <!{credhub}:blobstore_tls.ca!>
            password: <!{credhub}:blobstore_admin_users_password!>
            private_endpoint: https://blobstore.service.cf.internal:4443
            public_endpoint: https://blobstore.system.cf.testing.examle
            username: blobstore-user
        install_buildpacks:
        - name: staticfile_buildpack
          package: staticfile-buildpack-cflinuxfs3
        - name: java_buildpack
          package: java-buildpack-cflinuxfs3
        - name: ruby_buildpack
          package: ruby-buildpack-cflinuxfs3
        - name: dotnet_core_buildpack
          package: dotnet-core-buildpack-cflinuxfs3
        - name: nodejs_buildpack
          package: nodejs-buildpack-cflinuxfs3
        - name: go_buildpack
          package: go-buildpack-cflinuxfs3
        - name: python_buildpack
          package: python-buildpack-cflinuxfs3
        - name: php_buildpack
          package: php-buildpack-cflinuxfs3
        - name: nginx_buildpack
          package: nginx-buildpack-cflinuxfs3
        - name: r_buildpack
          package: r-buildpack-cflinuxfs3
        - name: binary_buildpack
          package: binary-buildpack-cflinuxfs3
        - name: hwc_buildpack
          package: hwc-buildpack-windows2016
        - name: hwc_buildpack
          package: hwc-buildpack-windows
        - name: binary_buildpack
          package: binary-buildpack-windows2016
        - name: binary_buildpack
          package: binary-buildpack-windows
        internal_api_password: <!{credhub}:cc_internal_api_password!>
        logcache_tls:
          certificate: <!{credhub}:cc_logcache_tls.certificate!>
          private_key: <!{credhub}:cc_logcache_tls.private_key!>
        min_cli_version: 6.23.0
        min_recommended_cli_version: 6.23.0
        mutual_tls:
          ca_cert: <!{credhub}:cc_tls.ca!>
          private_key: <!{credhub}:cc_tls.private_key!>
          public_cert: <!{credhub}:cc_tls.certificate!>
        packages:
          blobstore_type: webdav
          webdav_config:
            blobstore_timeout: 5
            ca_cert: <!{credhub}:blobstore_tls.ca!>
            password: <!{credhub}:blobstore_admin_users_password!>
            private_endpoint: https://blobstore.service.cf.internal:4443
            public_endpoint: https://blobstore.system.cf.testing.examle
            username: blobstore-user
        public_tls:
          ca_cert: <!{credhub}:cc_public_tls.ca!>
          certificate: <!{credhub}:cc_public_tls.certificate!>
          private_key: <!{credhub}:cc_public_tls.private_key!>
        resource_pool:
          blobstore_type: webdav
          webdav_config:
            blobstore_timeout: 5
            ca_cert: <!{credhub}:blobstore_tls.ca!>
            password: <!{credhub}:blobstore_admin_users_password!>
            private_endpoint: https://blobstore.service.cf.internal:4443
            public_endpoint: https://blobstore.system.cf.testing.examle
            username: blobstore-user
        security_group_definitions:
        - name: public_networks
          rules:
          - destination: 0.0.0.0-9.255.255.255
            protocol: all
          - destination: 11.0.0.0-169.253.255.255
            protocol: all
          - destination: 169.255.0.0-172.15.255.255
            protocol: all
          - destination: 172.32.0.0-192.167.255.255
            protocol: all
          - destination: 192.169.0.0-255.255.255.255
            protocol: all
        - name: dns
          rules:
          - destination: 0.0.0.0/0
            ports: "53"
            protocol: tcp
          - destination: 0.0.0.0/0
            ports: "53"
            protocol: udp
        stacks:
        - description: Cloud Foundry Linux-based filesystem (Ubuntu 18.04)
          name: cflinuxfs3
        - description: Windows Server 2016
          name: windows2016
        - description: Windows Server
          name: windows
        staging_upload_password: <!{credhub}:cc_staging_upload_password!>
        staging_upload_user: staging_user
        temporary_use_logcache: true
        volume_services_enabled: true
      ccdb:
        databases:
        - name: cloud_controller
          tag: cc
        db_scheme: postgres
        port: 5524
        roles:
        - name: cloud_controller
          password: <!{credhub}:cc_database_password!>
          tag: admin
      credhub_api:
        ca_cert: <!{credhub}:credhub_tls.ca!>
      description: Use `genesis info` on environment file for more details
      name: Cloud Foundry (compiled-windows-releases)
      router:
        route_services_secret: <!{credhub}:router_route_services_secret!>
      routing_api:
        enabled: true
      ssl:
        skip_cert_verify: true
      support_address: https://github.com/genesis-community/cf-genesis-kit
      system_domain: system.cf.testing.examle
      uaa:
        ca_cert: <!{credhub}:uaa_ssl.ca!>
        clients:
          cc-service-dashboards:
            secret: <!{credhub}:uaa_clients_cc-service-dashboards_secret!>
          cc_routing:
            secret: <!{credhub}:uaa_clients_cc-routing_secret!>
          cc_service_key_client:
            secret: <!{credhub}:uaa_clients_cc_service_key_client_secret!>
          cloud_controller_username_lookup:
            secret: <!{credhub}:uaa_clients_cloud_controller_username_lookup_secret!>
        url: https://uaa.system.cf.testing.examle
    provides:
      cloud_controller:
        as: cloud_controller
        shared: true
    release: capi
  - name: binary-buildpack
    release: binary-buildpack
  - name: dotnet-core-buildpack
    release: dotnet-core-buildpack
  - name: go-buildpack
    release: go-buildpack
  - name: java-buildpack
    release: java-buildpack
  - name: nodejs-buildpack
    release: nodejs-buildpack
  - name: nginx-buildpack
    release: nginx-buildpack
  - name: r-buildpack
    release: r-buildpack
  - name: php-buildpack
    release: php-buildpack
  - name: python-buildpack
    release: python-buildpack
  - name: ruby-buildpack
    release: ruby-buildpack
  - name: staticfile-buildpack
    release: staticfile-buildpack
  - name: route_registrar
    properties:
      nats:
        tls:
          client_cert: <!{credhub}:nats_client_cert.certificate!>
          client_key: <!{credhub}:nats_client_cert.private_key!>
          enabled: true
      route_registrar:
        routes:
        - health_check:
            name: api-health-check
            script_path: /var/vcap/jobs/cloud_controller_ng/bin/cloud_controller_ng_health_check
            timeout: 6s
          name: api
          port: 9022
          registration_interval: 10s
          server_cert_domain_san: api.system.cf.testing.examle
          tags:
            component: CloudController
          tls_port: 9024
          uris:
          - api.system.cf.testing.examle
        - name: policy-server
          registration_interval: 20s
          server_cert_domain_san: api.system.cf.testing.examle
          tls_port: 4002
          uris:
          - api.system.cf.testing.examle/networking
    release: routing
  - name: statsd_injector
    properties:
      loggregator:
        tls:
          ca_cert: <!{credhub}:loggregator_tls_statsdinjector.ca!>
          statsd_injector:
            cert: <!{credhub}:loggregator_tls_statsdinjector.certificate!>
            key: <!{credhub}:loggregator_tls_statsdinjector.private_key!>
    release: statsd-injector
  - name: file_server
    properties:
      bpm:
        enabled: true
      enable_consul_service_registration: false
      logging:
        format:
          timestamp: rfc3339
      loggregator:
        ca_cert: <!{credhub}:loggregator_tls_agent.ca!>
        cert: <!{credhub}:loggregator_tls_agent.certificate!>
        key: <!{credhub}:loggregator_tls_agent.private_key!>
        use_v2_api: true
    release: diego
  - name: routing-api
    properties:
      routing_api:
        enabled_api_endpoints: both
        locket:
          api_location: locket.service.cf.internal:8891
          ca_cert: <!{credhub}:diego_locket_client.ca!>
          client_cert: <!{credhub}:diego_locket_client.certificate!>
          client_key: <!{credhub}:diego_locket_client.private_key!>
        mtls_ca: <!{credhub}:routing_api_tls_client.ca!>
        mtls_client_cert: <!{credhub}:routing_api_tls_client.certificate!>
        mtls_client_key: <!{credhub}:routing_api_tls_client.private_key!>
        mtls_server_cert: <!{credhub}:routing_api_tls.certificate!>
        mtls_server_key: <!{credhub}:routing_api_tls.private_key!>
        router_groups:
        - name: default-tcp
          reservable_ports: 1024-1033
          type: tcp
        skip_consul_lock: true
        sqldb:
          host: sql-db.service.cf.internal
          password: <!{credhub}:routing_api_database_password!>
          port: 5524
          schema: routing-api
          type: postgres
          username: routing-api
        system_domain: system.cf.testing.examle
      uaa:
        ca_cert: <!{credhub}:uaa_ssl.ca!>
        tls_port: 8443
    release: routing
  - name: policy-server
    properties:
      database:
        host: sql-db.service.cf.internal
        name: network_policy
        password: <!{credhub}:network_policy_database_password!>
        port: 5524
        type: postgres
        username: network_policy
      enable_space_developer_self_service: true
      enable_tls: true
      server_cert: <!{credhub}:network_policy_server_external.certificate!>
      server_key: <!{credhub}:network_policy_server_external.private_key!>
      uaa_ca: <!{credhub}:uaa_ssl.ca!>
      uaa_client_secret: <!{credhub}:uaa_clients_network_policy_secret!>
    release: cf-networking
  - name: policy-server-internal
    properties:
      ca_cert: <!{credhub}:network_policy_server.ca!>
      server_cert: <!{credhub}:network_policy_server.certificate!>
      server_key: <!{credhub}:network_policy_server.private_key!>
    release: cf-networking
  - name: cc_uploader
    properties:
      capi:
        cc_uploader:
          cc:
            ca_cert: <!{credhub}:cc_bridge_cc_uploader.ca!>
            client_cert: <!{credhub}:cc_bridge_cc_uploader.certificate!>
            client_key: <!{credhub}:cc_bridge_cc_uploader.private_key!>
          mutual_tls:
            ca_cert: <!{credhub}:cc_bridge_cc_uploader_server.ca!>
            server_cert: <!{credhub}:cc_bridge_cc_uploader_server.certificate!>
            server_key: <!{credhub}:cc_bridge_cc_uploader_server.private_key!>
    release: capi
  - name: loggr-udp-forwarder
    properties:
      loggregator:
        tls:
          ca: <!{credhub}:loggregator_tls_agent.ca!>
          cert: <!{credhub}:loggregator_tls_agent.certificate!>
          key: <!{credhub}:loggregator_tls_agent.private_key!>
      metrics:
        ca_cert: <!{credhub}:loggr_udp_forwarder_tls.ca!>
        cert: <!{credhub}:loggr_udp_forwarder_tls.certificate!>
        key: <!{credhub}:loggr_udp_forwarder_tls.private_key!>
        server_name: loggr_udp_forwarder_metrics
    release: loggregator-agent
  - name: hwc-buildpack
    release: hwc-buildpack
  name: api
  networks:
  - name: cf-core
  stemcell: default
  vm_extensions:
  - 50GB_ephemeral_disk
  vm_type: small
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - name: cloud_controller_worker
    properties:
      cc:
        buildpacks:
          blobstore_type: webdav
          webdav_config:
            blobstore_timeout: 5
            ca_cert: <!{credhub}:blobstore_tls.ca!>
            password: <!{credhub}:blobstore_admin_users_password!>
            private_endpoint: https://blobstore.service.cf.internal:4443
            public_endpoint: https://blobstore.system.cf.testing.examle
            username: blobstore-user
        database_encryption:
          current_key_label: encryption_key_0
          keys:
            encryption_key_0: <!{credhub}:cc_db_encryption_key!>
        db_encryption_key: <!{credhub}:cc_db_encryption_key!>
        droplets:
          blobstore_type: webdav
          webdav_config:
            blobstore_timeout: 5
            ca_cert: <!{credhub}:blobstore_tls.ca!>
            password: <!{credhub}:blobstore_admin_users_password!>
            private_endpoint: https://blobstore.service.cf.internal:4443
            public_endpoint: https://blobstore.system.cf.testing.examle
            username: blobstore-user
        internal_api_password: <!{credhub}:cc_internal_api_password!>
        mutual_tls:
          ca_cert: <!{credhub}:cc_tls.ca!>
          private_key: <!{credhub}:cc_tls.private_key!>
          public_cert: <!{credhub}:cc_tls.certificate!>
        packages:
          blobstore_type: webdav
          webdav_config:
            blobstore_timeout: 5
            ca_cert: <!{credhub}:blobstore_tls.ca!>
            password: <!{credhub}:blobstore_admin_users_password!>
            private_endpoint: https://blobstore.service.cf.internal:4443
            public_endpoint: https://blobstore.system.cf.testing.examle
            username: blobstore-user
        resource_pool:
          blobstore_type: webdav
          webdav_config:
            blobstore_timeout: 5
            ca_cert: <!{credhub}:blobstore_tls.ca!>
            password: <!{credhub}:blobstore_admin_users_password!>
            private_endpoint: https://blobstore.service.cf.internal:4443
            public_endpoint: https://blobstore.system.cf.testing.examle
            username: blobstore-user
        staging_upload_password: <!{credhub}:cc_staging_upload_password!>
        staging_upload_user: staging_user
        volume_services_enabled: true
      ccdb:
        databases:
        - name: cloud_controller
          tag: cc
        db_scheme: postgres
        port: 5524
        roles:
        - name: cloud_controller
          password: <!{credhub}:cc_database_password!>
          tag: admin
      routing_api:
        enabled: true
      ssl:
        skip_cert_verify: true
      system_domain: system.cf.testing.examle
      uaa:
        ca_cert: <!{credhub}:uaa_ssl.ca!>
        clients:
          cc-service-dashboards:
            secret: <!{credhub}:uaa_clients_cc-service-dashboards_secret!>
          cc_routing:
            secret: <!{credhub}:uaa_clients_cc-routing_secret!>
    release: capi
  name: cc-worker
  networks:
  - name: cf-core
  stemcell: default
  vm_type: minimal
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - name: cfdot
    properties:
      tls:
        ca_certificate: <!{credhub}:diego_rep_client.ca!>
        certificate: <!{credhub}:diego_rep_client.certificate!>
        private_key: <!{credhub}:diego_rep_client.private_key!>
    release: diego
  - name: auctioneer
    properties:
      bpm:
        enabled: true
      diego:
        auctioneer:
          bbs:
            ca_cert: <!{credhub}:diego_bbs_client.ca!>
            client_cert: <!{credhub}:diego_bbs_client.certificate!>
            client_key: <!{credhub}:diego_bbs_client.private_key!>
          ca_cert: <!{credhub}:diego_auctioneer_server.ca!>
          rep:
            ca_cert: <!{credhub}:diego_rep_client.ca!>
            client_cert: <!{credhub}:diego_rep_client.certificate!>
            client_key: <!{credhub}:diego_rep_client.private_key!>
            require_tls: true
          server_cert: <!{credhub}:diego_auctioneer_server.certificate!>
          server_key: <!{credhub}:diego_auctioneer_server.private_key!>
          skip_consul_lock: true
      enable_consul_service_registration: false
      logging:
        format:
          timestamp: rfc3339
      loggregator:
        ca_cert: <!{credhub}:loggregator_tls_agent.ca!>
        cert: <!{credhub}:loggregator_tls_agent.certificate!>
        key: <!{credhub}:loggregator_tls_agent.private_key!>
        use_v2_api: true
    release: diego
  - name: cloud_controller_clock
    properties:
      cc:
        buildpacks:
          blobstore_type: webdav
          webdav_config:
            blobstore_timeout: 5
            ca_cert: <!{credhub}:blobstore_tls.ca!>
            password: <!{credhub}:blobstore_admin_users_password!>
            private_endpoint: https://blobstore.service.cf.internal:4443
            public_endpoint: https://blobstore.system.cf.testing.examle
            username: blobstore-user
        database_encryption:
          current_key_label: encryption_key_0
          keys:
            encryption_key_0: <!{credhub}:cc_db_encryption_key!>
        db_encryption_key: <!{credhub}:cc_db_encryption_key!>
        droplets:
          blobstore_type: webdav
          webdav_config:
            blobstore_timeout: 5
            ca_cert: <!{credhub}:blobstore_tls.ca!>
            password: <!{credhub}:blobstore_admin_users_password!>
            private_endpoint: https://blobstore.service.cf.internal:4443
            public_endpoint: https://blobstore.system.cf.testing.examle
            username: blobstore-user
        internal_api_password: <!{credhub}:cc_internal_api_password!>
        mutual_tls:
          ca_cert: <!{credhub}:cc_tls.ca!>
          private_key: <!{credhub}:cc_tls.private_key!>
          public_cert: <!{credhub}:cc_tls.certificate!>
        packages:
          blobstore_type: webdav
          webdav_config:
            blobstore_timeout: 5
            ca_cert: <!{credhub}:blobstore_tls.ca!>
            password: <!{credhub}:blobstore_admin_users_password!>
            private_endpoint: https://blobstore.service.cf.internal:4443
            public_endpoint: https://blobstore.system.cf.testing.examle
            username: blobstore-user
        resource_pool:
          blobstore_type: webdav
          webdav_config:
            blobstore_timeout: 5
            ca_cert: <!{credhub}:blobstore_tls.ca!>
            password: <!{credhub}:blobstore_admin_users_password!>
            private_endpoint: https://blobstore.service.cf.internal:4443
            public_endpoint: https://blobstore.system.cf.testing.examle
            username: blobstore-user
        staging_upload_password: <!{credhub}:cc_staging_upload_password!>
        staging_upload_user: staging_user
        volume_services_enabled: true
      ccdb:
        databases:
        - name: cloud_controller
          tag: cc
        db_scheme: postgres
        port: 5524
        roles:
        - name: cloud_controller
          password: <!{credhub}:cc_database_password!>
          tag: admin
      routing_api:
        enabled: true
      ssl:
        skip_cert_verify: true
      system_domain: system.cf.testing.examle
      uaa:
        ca_cert: <!{credhub}:uaa_ssl.ca!>
        clients:
          cc-service-dashboards:
            secret: <!{credhub}:uaa_clients_cc-service-dashboards_secret!>
          cc_routing:
            secret: <!{credhub}:uaa_clients_cc-routing_secret!>
        ssl:
          port: 8443
    release: capi
  - name: cc_deployment_updater
    properties:
      cc:
        db_encryption_key: <!{credhub}:cc_db_encryption_key!>
        mutual_tls:
          ca_cert: <!{credhub}:cc_tls.ca!>
          private_key: <!{credhub}:cc_tls.private_key!>
          public_cert: <!{credhub}:cc_tls.certificate!>
      ccdb:
        databases:
        - name: cloud_controller
          tag: cc
        db_scheme: postgres
        port: 5524
        roles:
        - name: cloud_controller
          password: <!{credhub}:cc_database_password!>
          tag: admin
    release: capi
  - name: service-discovery-controller
    properties:
      dnshttps:
        client:
          ca: <!{credhub}:cf_app_sd_server_tls.ca!>
        server:
          tls:
            ca: <!{credhub}:cf_app_sd_server_tls.ca!>
            certificate: <!{credhub}:cf_app_sd_server_tls.certificate!>
            private_key: <!{credhub}:cf_app_sd_server_tls.private_key!>
      nats:
        cert_chain: <!{credhub}:nats_client_cert.certificate!>
        private_key: <!{credhub}:nats_client_cert.private_key!>
        tls_enabled: true
    release: cf-networking
  - name: statsd_injector
    properties:
      loggregator:
        tls:
          ca_cert: <!{credhub}:loggregator_tls_statsdinjector.ca!>
          statsd_injector:
            cert: <!{credhub}:loggregator_tls_statsdinjector.certificate!>
            key: <!{credhub}:loggregator_tls_statsdinjector.private_key!>
    release: statsd-injector
  - name: tps
    properties:
      capi:
        tps:
          bbs:
            ca_cert: <!{credhub}:diego_bbs_client.ca!>
            client_cert: <!{credhub}:diego_bbs_client.certificate!>
            client_key: <!{credhub}:diego_bbs_client.private_key!>
          cc:
            ca_cert: <!{credhub}:cc_bridge_tps.ca!>
            client_cert: <!{credhub}:cc_bridge_tps.certificate!>
            client_key: <!{credhub}:cc_bridge_tps.private_key!>
          watcher:
            locket:
              api_location: locket.service.cf.internal:8891
            skip_consul_lock: true
    release: capi
  - name: ssh_proxy
    properties:
      backends:
        tls:
          ca_certificates:
          - <!{credhub}:diego_instance_identity_ca.ca!>
          client_certificate: <!{credhub}:ssh_proxy_backends_tls.certificate!>
          client_private_key: <!{credhub}:ssh_proxy_backends_tls.private_key!>
          enabled: true
      bpm:
        enabled: true
      diego:
        ssh_proxy:
          bbs:
            ca_cert: <!{credhub}:diego_bbs_client.ca!>
            client_cert: <!{credhub}:diego_bbs_client.certificate!>
            client_key: <!{credhub}:diego_bbs_client.private_key!>
          disable_healthcheck_server: true
          enable_cf_auth: true
          host_key: <!{credhub}:diego_ssh_proxy_host_key.private_key!>
          uaa:
            ca_cert: <!{credhub}:uaa_ssl.ca!>
          uaa_secret: <!{credhub}:uaa_clients_ssh-proxy_secret!>
      enable_consul_service_registration: false
      logging:
        format:
          timestamp: rfc3339
      loggregator:
        ca_cert: <!{credhub}:loggregator_tls_agent.ca!>
        cert: <!{credhub}:loggregator_tls_agent.certificate!>
        key: <!{credhub}:loggregator_tls_agent.private_key!>
        use_v2_api: true
    release: diego
  - name: loggr-syslog-binding-cache
    properties:
      api:
        tls:
          ca_cert: <!{credhub}:cc_tls.ca!>
          cert: <!{credhub}:binding_cache_api_tls.certificate!>
          cn: cloud-controller-ng.service.cf.internal
          key: <!{credhub}:binding_cache_api_tls.private_key!>
      external_port: 9000
      metrics:
        ca_cert: <!{credhub}:loggr_syslog_binding_cache_metrics_tls.ca!>
        cert: <!{credhub}:loggr_syslog_binding_cache_metrics_tls.certificate!>
        key: <!{credhub}:loggr_syslog_binding_cache_metrics_tls.private_key!>
        server_name: loggr_syslog_binding_cache_metrics
      tls:
        ca_cert: <!{credhub}:binding_cache_tls.ca!>
        cert: <!{credhub}:binding_cache_tls.certificate!>
        cn: binding-cache
        key: <!{credhub}:binding_cache_tls.private_key!>
    release: loggregator-agent
  - name: loggr-udp-forwarder
    properties:
      loggregator:
        tls:
          ca: <!{credhub}:loggregator_tls_agent.ca!>
          cert: <!{credhub}:loggregator_tls_agent.certificate!>
          key: <!{credhub}:loggregator_tls_agent.private_key!>
      metrics:
        ca_cert: <!{credhub}:loggr_udp_forwarder_tls.ca!>
        cert: <!{credhub}:loggr_udp_forwarder_tls.certificate!>
        key: <!{credhub}:loggr_udp_forwarder_tls.private_key!>
        server_name: loggr_udp_forwarder_metrics
    release: loggregator-agent
  migrated_from:
  - name: cc-bridge
  - name: cc-clock
  - name: diego-brain
  name: scheduler
  networks:
  - name: cf-core
  stemcell: default
  vm_extensions:
  - diego-ssh-proxy-network-properties
  vm_type: minimal
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - name: gorouter
    properties:
      nats:
        cert_chain: <!{credhub}:nats_client_cert.certificate!>
        private_key: <!{credhub}:nats_client_cert.private_key!>
        tls_enabled: true
      router:
        backends:
          cert_chain: <!{credhub}:gorouter_backend_tls.certificate!>
          private_key: <!{credhub}:gorouter_backend_tls.private_key!>
        ca_certs: |
          <!{credhub}:diego_instance_identity_ca.ca!>
          <!{credhub}:cc_tls.ca!>
          <!{credhub}:uaa_ssl.ca!>
          <!{credhub}:network_policy_server_external.ca!>
        enable_ssl: true
        route_services_secret: <!{credhub}:router_route_services_secret!>
        status:
          password: <!{credhub}:router_status_password!>
          user: router-status
        tls_pem:
        - cert_chain: <!{credhub}:router_ssl.certificate!>
          private_key: <!{credhub}:router_ssl.private_key!>
        tracing:
          enable_zipkin: true
      routing_api:
        enabled: true
      uaa:
        ca_cert: <!{credhub}:uaa_ssl.ca!>
        clients:
          gorouter:
            secret: <!{credhub}:uaa_clients_gorouter_secret!>
        ssl:
          port: 8443
    release: routing
  - name: loggr-udp-forwarder
    properties:
      loggregator:
        tls:
          ca: <!{credhub}:loggregator_tls_agent.ca!>
          cert: <!{credhub}:loggregator_tls_agent.certificate!>
          key: <!{credhub}:loggregator_tls_agent.private_key!>
      metrics:
        ca_cert: <!{credhub}:loggr_udp_forwarder_tls.ca!>
        cert: <!{credhub}:loggr_udp_forwarder_tls.certificate!>
        key: <!{credhub}:loggr_udp_forwarder_tls.private_key!>
        server_name: loggr_udp_forwarder_metrics
    release: loggregator-agent
  name: router
  networks:
  - name: cf-edge
  stemcell: default
  update:
    serial: true
  vm_extensions:
  - cf-router-network-properties
  vm_type: minimal
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - name: tcp_router
    properties:
      tcp_router:
        oauth_secret: <!{credhub}:uaa_clients_tcp_router_secret!>
        router_group: default-tcp
      uaa:
        ca_cert: <!{credhub}:uaa_ssl.ca!>
        tls_port: 8443
    release: routing
  - name: loggr-udp-forwarder
    properties:
      loggregator:
        tls:
          ca: <!{credhub}:loggregator_tls_agent.ca!>
          cert: <!{credhub}:loggregator_tls_agent.certificate!>
          key: <!{credhub}:loggregator_tls_agent.private_key!>
      metrics:
        ca_cert: <!{credhub}:loggr_udp_forwarder_tls.ca!>
        cert: <!{credhub}:loggr_udp_forwarder_tls.certificate!>
        key: <!{credhub}:loggr_udp_forwarder_tls.private_key!>
        server_name: loggr_udp_forwarder_metrics
    release: loggregator-agent
  name: tcp-router
  networks:
  - name: cf-edge
  stemcell: default
  vm_extensions:
  - cf-tcp-router-network-properties
  vm_type: minimal
- azs:
  - z1
  - z2
  instances: 4
  jobs:
  - name: doppler
    properties:
      loggregator:
        tls:
          ca_cert: <!{credhub}:loggregator_tls_doppler.ca!>
          doppler:
            cert: <!{credhub}:loggregator_tls_doppler.certificate!>
            key: <!{credhub}:loggregator_tls_doppler.private_key!>
    provides:
      doppler:
        as: doppler
        shared: true
    release: loggregator
  - name: log-cache
    properties:
      health_addr: localhost:6060
      metrics:
        ca_cert: <!{credhub}:log_cache_metrics_tls.ca!>
        cert: <!{credhub}:log_cache_metrics_tls.certificate!>
        key: <!{credhub}:log_cache_metrics_tls.private_key!>
        server_name: log_cache_metrics
      tls:
        ca_cert: <!{credhub}:log_cache.ca!>
        cert: <!{credhub}:log_cache.certificate!>
        key: <!{credhub}:log_cache.private_key!>
    provides:
      log-cache:
        shared: true
    release: log-cache
  - name: log-cache-gateway
    properties:
      gateway_addr: localhost:8081
      metrics:
        ca_cert: <!{credhub}:log_cache_gateway_metrics_tls.ca!>
        cert: <!{credhub}:log_cache_gateway_metrics_tls.certificate!>
        key: <!{credhub}:log_cache_gateway_metrics_tls.private_key!>
        server_name: log_cache_gateway_metrics
      proxy_cert: <!{credhub}:log_cache_proxy_tls.certificate!>
      proxy_key: <!{credhub}:log_cache_proxy_tls.private_key!>
    release: log-cache
  - consumes:
      reverse_log_proxy:
        from: reverse_log_proxy
    name: log-cache-nozzle
    properties:
      logs_provider:
        tls:
          ca_cert: <!{credhub}:logs_provider.ca!>
          cert: <!{credhub}:logs_provider.certificate!>
          key: <!{credhub}:logs_provider.private_key!>
      metrics:
        ca_cert: <!{credhub}:log_cache_nozzle_metrics_tls.ca!>
        cert: <!{credhub}:log_cache_nozzle_metrics_tls.certificate!>
        key: <!{credhub}:log_cache_nozzle_metrics_tls.private_key!>
        server_name: log_cache_nozzle_metrics
    release: log-cache
  - name: route_registrar
    properties:
      nats:
        tls:
          client_cert: <!{credhub}:nats_client_cert.certificate!>
          client_key: <!{credhub}:nats_client_cert.private_key!>
          enabled: true
      route_registrar:
        routes:
        - name: log-cache-reverse-proxy
          port: 8083
          registration_interval: 20s
          server_cert_domain_san: log-cache.system.cf.testing.examle
          tls_port: 8083
          uris:
          - log-cache.system.cf.testing.examle
          - '*.log-cache.system.cf.testing.examle'
    release: routing
  - name: log-cache-cf-auth-proxy
    properties:
      cc:
        ca_cert: <!{credhub}:cc_tls.ca!>
        common_name: cloud-controller-ng.service.cf.internal
      external_cert: <!{credhub}:logcache_ssl.certificate!>
      external_key: <!{credhub}:logcache_ssl.private_key!>
      metrics:
        ca_cert: <!{credhub}:log_cache_cf_auth_proxy_metrics_tls.ca!>
        cert: <!{credhub}:log_cache_cf_auth_proxy_metrics_tls.certificate!>
        key: <!{credhub}:log_cache_cf_auth_proxy_metrics_tls.private_key!>
        server_name: log_cache_cf_auth_proxy_metrics
      proxy_ca_cert: <!{credhub}:log_cache.ca!>
      proxy_port: 8083
      uaa:
        ca_cert: <!{credhub}:uaa_ssl.ca!>
        client_id: doppler
        client_secret: <!{credhub}:uaa_clients_doppler_secret!>
        internal_addr: https://uaa.service.cf.internal:8443
    release: log-cache
  name: doppler
  networks:
  - name: cf-core
  stemcell: default
  vm_type: minimal
- azs:
  - z1
  - z2
  instances: 3
  jobs:
  - name: bosh-dns-adapter
    properties:
      dnshttps:
        client:
          tls:
            ca: <!{credhub}:cf_app_sd_client_tls.ca!>
            certificate: <!{credhub}:cf_app_sd_client_tls.certificate!>
            private_key: <!{credhub}:cf_app_sd_client_tls.private_key!>
        server:
          ca: <!{credhub}:cf_app_sd_client_tls.ca!>
      internal_domains:
      - apps.internal.
    release: cf-networking
  - name: cflinuxfs3-rootfs-setup
    properties:
      cflinuxfs3-rootfs:
        trusted_certs:
        - <!{credhub}:diego_instance_identity_ca.ca!>
        - <!{credhub}:credhub_tls.ca!>
        - <!{credhub}:uaa_ssl.ca!>
    release: cflinuxfs3
  - name: garden
    properties:
      garden:
        cleanup_process_dirs_on_wait: true
        containerd_mode: true
        debug_listen_address: 127.0.0.1:17019
        default_container_grace_time: 0
        deny_networks:
        - 0.0.0.0/0
        destroy_containers_on_start: true
        network_plugin: /var/vcap/packages/runc-cni/bin/garden-external-networker
        network_plugin_extra_args:
        - --configFile=/var/vcap/jobs/garden-cni/config/adapter.json
      logging:
        format:
          timestamp: rfc3339
    release: garden-runc
  - name: rep
    properties:
      bpm:
        enabled: true
      containers:
        proxy:
          enabled: true
          require_and_verify_client_certificates: true
          trusted_ca_certificates:
          - <!{credhub}:gorouter_backend_tls.ca!>
          - <!{credhub}:ssh_proxy_backends_tls.ca!>
          verify_subject_alt_name:
          - gorouter.service.cf.internal
          - ssh-proxy.service.cf.internal
        trusted_ca_certificates:
        - <!{credhub}:diego_instance_identity_ca.ca!>
        - <!{credhub}:credhub_tls.ca!>
        - <!{credhub}:uaa_ssl.ca!>
      diego:
        executor:
          instance_identity_ca_cert: <!{credhub}:diego_instance_identity_ca.certificate!>
          instance_identity_key: <!{credhub}:diego_instance_identity_ca.private_key!>
        rep:
          preloaded_rootfses:
          - cflinuxfs3:/var/vcap/packages/cflinuxfs3/rootfs.tar
      enable_consul_service_registration: false
      enable_declarative_healthcheck: true
      logging:
        format:
          timestamp: rfc3339
      loggregator:
        ca_cert: <!{credhub}:loggregator_tls_agent.ca!>
        cert: <!{credhub}:loggregator_tls_agent.certificate!>
        key: <!{credhub}:loggregator_tls_agent.private_key!>
        use_v2_api: true
      tls:
        ca_cert: <!{credhub}:diego_rep_agent_v2.ca!>
        cert: <!{credhub}:diego_rep_agent_v2.certificate!>
        key: <!{credhub}:diego_rep_agent_v2.private_key!>
    release: diego
  - name: cfdot
    properties:
      tls:
        ca_certificate: <!{credhub}:diego_rep_client.ca!>
        certificate: <!{credhub}:diego_rep_client.certificate!>
        private_key: <!{credhub}:diego_rep_client.private_key!>
    release: diego
  - consumes:
      nats:
        ip_addresses: false
      nats-tls:
        ip_addresses: false
    name: route_emitter
    properties:
      bpm:
        enabled: true
      diego:
        route_emitter:
          bbs:
            ca_cert: <!{credhub}:diego_bbs_client.ca!>
            client_cert: <!{credhub}:diego_bbs_client.certificate!>
            client_key: <!{credhub}:diego_bbs_client.private_key!>
          local_mode: true
          nats:
            tls:
              client_cert: <!{credhub}:nats_client_cert.certificate!>
              client_key: <!{credhub}:nats_client_cert.private_key!>
              enabled: true
      internal_routes:
        enabled: true
      logging:
        format:
          timestamp: rfc3339
      loggregator:
        ca_cert: <!{credhub}:loggregator_tls_agent.ca!>
        cert: <!{credhub}:loggregator_tls_agent.certificate!>
        key: <!{credhub}:loggregator_tls_agent.private_key!>
        use_v2_api: true
      tcp:
        enabled: true
      uaa:
        ca_cert: <!{credhub}:uaa_ssl.ca!>
        client_secret: <!{credhub}:uaa_clients_tcp_emitter_secret!>
    release: diego
  - name: garden-cni
    properties:
      cni_config_dir: /var/vcap/jobs/silk-cni/config/cni
      cni_plugin_dir: /var/vcap/packages/silk-cni/bin
    release: cf-networking
  - name: netmon
    release: silk
  - name: vxlan-policy-agent
    properties:
      ca_cert: <!{credhub}:network_policy_client.ca!>
      client_cert: <!{credhub}:network_policy_client.certificate!>
      client_key: <!{credhub}:network_policy_client.private_key!>
    release: silk
  - name: silk-daemon
    properties:
      ca_cert: <!{credhub}:silk_daemon.ca!>
      client_cert: <!{credhub}:silk_daemon.certificate!>
      client_key: <!{credhub}:silk_daemon.private_key!>
    release: silk
  - name: silk-cni
    properties:
      dns_servers:
      - 169.254.0.2
    release: silk
  - name: loggr-udp-forwarder
    properties:
      loggregator:
        tls:
          ca: <!{credhub}:loggregator_tls_agent.ca!>
          cert: <!{credhub}:loggregator_tls_agent.certificate!>
          key: <!{credhub}:loggregator_tls_agent.private_key!>
      metrics:
        ca_cert: <!{credhub}:loggr_udp_forwarder_tls.ca!>
        cert: <!{credhub}:loggr_udp_forwarder_tls.certificate!>
        key: <!{credhub}:loggr_udp_forwarder_tls.private_key!>
        server_name: loggr_udp_forwarder_metrics
    release: loggregator-agent
  - name: smbdriver
    properties:
      tls:
        ca_cert: <!{credhub}:smbdriver_cert.ca!>
        client_cert: <!{credhub}:smbdriver_client_cert.certificate!>
        client_key: <!{credhub}:smbdriver_client_cert.private_key!>
        server_cert: <!{credhub}:smbdriver_cert.certificate!>
        server_key: <!{credhub}:smbdriver_cert.private_key!>
    release: smb-volume
  name: diego-cell
  networks:
  - name: cf-runtime
  stemcell: default
  vm_extensions:
  - 100GB_ephemeral_disk
  vm_type: small-highmem
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - consumes:
      doppler:
        from: doppler
    name: loggregator_trafficcontroller
    properties:
      cc:
        internal_service_hostname: cloud-controller-ng.service.cf.internal
        mutual_tls:
          ca_cert: <!{credhub}:cc_tls.ca!>
        tls_port: 9023
      loggregator:
        outgoing_cert: <!{credhub}:loggregator_trafficcontroller_tls.certificate!>
        outgoing_key: <!{credhub}:loggregator_trafficcontroller_tls.private_key!>
        tls:
          ca_cert: <!{credhub}:loggregator_tls_tc.ca!>
          cc_trafficcontroller:
            cert: <!{credhub}:loggregator_tls_cc_tc.certificate!>
            key: <!{credhub}:loggregator_tls_cc_tc.private_key!>
          trafficcontroller:
            cert: <!{credhub}:loggregator_tls_tc.certificate!>
            key: <!{credhub}:loggregator_tls_tc.private_key!>
        uaa:
          client_secret: <!{credhub}:uaa_clients_doppler_secret!>
      ssl:
        skip_cert_verify: true
      system_domain: system.cf.testing.examle
      uaa:
        ca_cert: <!{credhub}:uaa_ssl.ca!>
        internal_url: https://uaa.service.cf.internal:8443
    release: loggregator
  - name: reverse_log_proxy
    properties:
      loggregator:
        tls:
          ca_cert: <!{credhub}:loggregator_tls_rlp.ca!>
          reverse_log_proxy:
            cert: <!{credhub}:loggregator_tls_rlp.certificate!>
            key: <!{credhub}:loggregator_tls_rlp.private_key!>
    provides:
      reverse_log_proxy:
        as: reverse_log_proxy
        shared: true
    release: loggregator
  - name: reverse_log_proxy_gateway
    properties:
      cc:
        ca_cert: <!{credhub}:loggregator_rlp_gateway_tls_cc.ca!>
        capi_internal_addr: https://cloud-controller-ng.service.cf.internal:9023
        cert: <!{credhub}:loggregator_rlp_gateway_tls_cc.certificate!>
        common_name: cloud-controller-ng.service.cf.internal
        key: <!{credhub}:loggregator_rlp_gateway_tls_cc.private_key!>
      http:
        address: 0.0.0.0:8088
        cert: <!{credhub}:loggregator_rlp_gateway_tls.certificate!>
        key: <!{credhub}:loggregator_rlp_gateway_tls.private_key!>
      logs_provider:
        ca_cert: <!{credhub}:loggregator_rlp_gateway.ca!>
        client_cert: <!{credhub}:loggregator_rlp_gateway.certificate!>
        client_key: <!{credhub}:loggregator_rlp_gateway.private_key!>
      metrics:
        ca_cert: <!{credhub}:rlp_gateway_metrics_tls.ca!>
        cert: <!{credhub}:rlp_gateway_metrics_tls.certificate!>
        key: <!{credhub}:rlp_gateway_metrics_tls.private_key!>
        server_name: rlp_gateway_metrics
      uaa:
        ca_cert: <!{credhub}:uaa_ssl.ca!>
        client_id: doppler
        client_secret: <!{credhub}:uaa_clients_doppler_secret!>
        internal_addr: https://uaa.service.cf.internal:8443
    release: loggregator
  - name: route_registrar
    properties:
      nats:
        tls:
          client_cert: <!{credhub}:nats_client_cert.certificate!>
          client_key: <!{credhub}:nats_client_cert.private_key!>
          enabled: true
      route_registrar:
        routes:
        - name: doppler
          registration_interval: 20s
          server_cert_domain_san: doppler.system.cf.testing.examle
          tls_port: 8081
          uris:
          - doppler.system.cf.testing.examle
          - '*.doppler.system.cf.testing.examle'
        - name: rlp-gateway
          registration_interval: 20s
          server_cert_domain_san: log-stream.system.cf.testing.examle
          tls_port: 8088
          uris:
          - log-stream.system.cf.testing.examle
          - '*.log-stream.system.cf.testing.examle'
    release: routing
  name: log-api
  networks:
  - name: cf-core
  stemcell: default
  vm_type: minimal
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - name: credhub
    properties:
      credhub:
        authentication:
          mutual_tls:
            trusted_cas:
            - <!{credhub}:diego_instance_identity_ca.ca!>
          uaa:
            ca_certs:
            - <!{credhub}:uaa_ssl.ca!>
            url: https://uaa.service.cf.internal:8443
        authorization:
          acls:
            enabled: true
          permissions:
          - actors:
            - uaa-client:credhub_admin_client
            operations:
            - read
            - write
            - delete
            - read_acl
            - write_acl
            path: /*
          - actors:
            - uaa-client:cc_service_key_client
            operations:
            - read
            path: /*
          - actors:
            - uaa-client:smb-broker-credhub-client
            operations:
            - read
            - write
            - delete
            - read_acl
            - write_acl
            path: /smbbroker/*
        ca_certificate: |
          <!{credhub}:credhub_tls.ca!>
        data_storage:
          database: credhub
          host: sql-db.service.cf.internal
          password: <!{credhub}:credhub_database_password!>
          port: 5524
          require_tls: false
          type: postgres
          username: credhub
        encryption:
          keys:
          - active: true
            key_properties:
              encryption_password: <!{credhub}:credhub_encryption_password!>
            provider_name: internal-provider
          providers:
          - name: internal-provider
            type: internal
        internal_url: https://credhub.service.cf.internal
        tls:
          ca: <!{credhub}:credhub_tls.ca!>
          certificate: <!{credhub}:credhub_tls.certificate!>
          private_key: <!{credhub}:credhub_tls.private_key!>
    release: credhub
  name: credhub
  networks:
  - name: cf-core
  stemcell: default
  vm_type: minimal
- azs:
  - z1
  - z2
  instances: 1
  jobs:
  - name: rotate_cc_database_key
    properties: {}
    release: capi
  lifecycle: errand
  name: rotate-cc-database-key
  networks:
  - name: cf-core
  stemcell: default
  vm_type: minimal
- azs:
  - z1
  - z2
  instances: 1
  jobs:
  - name: winc
    release: winc
  - name: winc-network-hns-acls
    properties:
      winc_network:
        dns_servers:
        - 172.30.0.1
    release: winc
  - name: groot
    properties:
      groot:
        cached_image_uris:
        - oci:///C:/var/vcap/packages/windows2019fs
        driver_store: /var/vcap/data/groot
    release: winc
  - name: garden-windows
    properties:
      garden:
        destroy_containers_on_start: true
        image_plugin: /var/vcap/packages/groot/groot.exe
        image_plugin_extra_args:
        - --driver-store=/var/vcap/data/groot
        - --config=/var/vcap/jobs/groot/config/groot.yml
        listen_address: 127.0.0.1:9241
        network_plugin: /var/vcap/packages/winc-network-hns-acls/winc-network.exe
        network_plugin_extra_args:
        - --configFile=/var/vcap/jobs/winc-network-hns-acls/config/interface.json
        - --log=/var/vcap/sys/log/winc-network-hns-acls/winc-network.log
        nstar_bin: /var/vcap/packages/nstar/nstar.exe
        runtime_plugin: /var/vcap/packages/winc/winc.exe
    release: garden-runc
  - name: rep_windows
    properties:
      containers:
        trusted_ca_certificates:
        - <!{credhub}:diego_instance_identity_ca.ca!>
        - <!{credhub}:credhub_tls.ca!>
        - <!{credhub}:uaa_ssl.ca!>
      declarative_healthcheck_path: /var/vcap/packages/healthcheck_windows/internal
      diego:
        executor:
          instance_identity_ca_cert: <!{credhub}:diego_instance_identity_ca.certificate!>
          instance_identity_key: <!{credhub}:diego_instance_identity_ca.private_key!>
        rep:
          open_bindmounts_acl: true
          preloaded_rootfses:
          - windows2016:oci:///C:/var/vcap/packages/windows2019fs
          - windows:oci:///C:/var/vcap/packages/windows2019fs
      enable_consul_service_registration: false
      enable_declarative_healthcheck: true
      logging:
        format:
          timestamp: rfc3339
      loggregator:
        ca_cert: <!{credhub}:loggregator_tls_agent.ca!>
        cert: <!{credhub}:loggregator_tls_agent.certificate!>
        key: <!{credhub}:loggregator_tls_agent.private_key!>
        use_v2_api: true
      syslog_daemon_config:
        enable: false
      tls:
        ca_cert: <!{credhub}:diego_rep_agent_v2.ca!>
        cert: <!{credhub}:diego_rep_agent_v2.certificate!>
        key: <!{credhub}:diego_rep_agent_v2.private_key!>
    release: diego
  - consumes:
      nats:
        ip_addresses: false
      nats-tls:
        ip_addresses: false
    name: route_emitter_windows
    properties:
      diego:
        route_emitter:
          bbs:
            ca_cert: <!{credhub}:diego_bbs_client.ca!>
            client_cert: <!{credhub}:diego_bbs_client.certificate!>
            client_key: <!{credhub}:diego_bbs_client.private_key!>
          local_mode: true
          nats:
            tls:
              client_cert: <!{credhub}:nats_client_cert.certificate!>
              client_key: <!{credhub}:nats_client_cert.private_key!>
              enabled: true
      logging:
        format:
          timestamp: rfc3339
      loggregator:
        ca_cert: <!{credhub}:loggregator_tls_agent.ca!>
        cert: <!{credhub}:loggregator_tls_agent.certificate!>
        key: <!{credhub}:loggregator_tls_agent.private_key!>
        use_v2_api: true
    release: diego
  - name: loggregator_agent_windows
    properties:
      grpc_port: 3459
      loggregator:
        tls:
          agent:
            cert: <!{credhub}:loggregator_tls_agent.certificate!>
            key: <!{credhub}:loggregator_tls_agent.private_key!>
          ca_cert: <!{credhub}:loggregator_tls_agent.ca!>
      metrics:
        ca_cert: <!{credhub}:loggregator_agent_metrics_tls.ca!>
        cert: <!{credhub}:loggregator_agent_metrics_tls.certificate!>
        key: <!{credhub}:loggregator_agent_metrics_tls.private_key!>
        server_name: loggregator_agent_metrics
      syslog_daemon_config:
        enable: false
    release: loggregator-agent
  - name: loggr-syslog-agent-windows
    properties:
      cache:
        tls:
          ca_cert: <!{credhub}:syslog_agent_api_tls.ca!>
          cert: <!{credhub}:syslog_agent_api_tls.certificate!>
          cn: binding-cache
          key: <!{credhub}:syslog_agent_api_tls.private_key!>
      metrics:
        ca_cert: <!{credhub}:syslog_agent_metrics_tls.ca!>
        cert: <!{credhub}:syslog_agent_metrics_tls.certificate!>
        key: <!{credhub}:syslog_agent_metrics_tls.private_key!>
        server_name: syslog_agent_metrics
      port: 3460
      tls:
        ca_cert: <!{credhub}:loggregator_tls_agent.ca!>
        cert: <!{credhub}:loggregator_tls_agent.certificate!>
        key: <!{credhub}:loggregator_tls_agent.private_key!>
    release: loggregator-agent
  - name: loggr-forwarder-agent-windows
    properties:
      downstream_ingress_ports:
      - 3459
      - 3460
      metrics:
        ca_cert: <!{credhub}:forwarder_agent_metrics_tls.ca!>
        cert: <!{credhub}:forwarder_agent_metrics_tls.certificate!>
        key: <!{credhub}:forwarder_agent_metrics_tls.private_key!>
        server_name: forwarder_agent_metrics
      tls:
        ca_cert: <!{credhub}:loggregator_tls_agent.ca!>
        cert: <!{credhub}:loggregator_tls_agent.certificate!>
        key: <!{credhub}:loggregator_tls_agent.private_key!>
    release: loggregator-agent
  - name: prom_scraper_windows
    properties:
      metrics:
        ca_cert: <!{credhub}:prom_scraper_metrics_tls.ca!>
        cert: <!{credhub}:prom_scraper_metrics_tls.certificate!>
        key: <!{credhub}:prom_scraper_metrics_tls.private_key!>
        server_name: prom_scraper_metrics
      scrape:
        tls:
          ca_cert: <!{credhub}:prom_scraper_scrape_tls.ca!>
          cert: <!{credhub}:prom_scraper_scrape_tls.certificate!>
          key: <!{credhub}:prom_scraper_scrape_tls.private_key!>
      scrape_interval: 60s
    release: loggregator-agent
  - name: enable_ssh
    release: windows-utilities
  - name: windows2019fs
    release: windowsfs
  - name: resize_root_disk
    properties: {}
    release: windows-resize-root-disk
  name: windows2019-cell
  networks:
  - name: cf-runtime
  stemcell: windows2019
  vm_extensions:
  - 100GB_ephemeral_disk
  vm_type: small-highmem
- azs:
  - z1
  - z2
  instances: 1
  jobs:
  - name: smbbrokerpush
    properties:
      app_domain: system.cf.testing.examle
      cf:
        client_id: smb-broker-client
        client_secret: <!{credhub}:smb-broker-uaa-client-secret!>
      credhub:
        store_id: smbbroker
        uaa_client_id: smb-broker-credhub-client
        uaa_client_secret: <!{credhub}:smb-broker-credhub-uaa-client-secret!>
        url: https://credhub.service.cf.internal:8844
      domain: system.cf.testing.examle
      organization: system
      password: <!{credhub}:smb-broker-password!>
      skip_cert_verify: true
      space: smb-broker-space
      syslog_url: ""
      username: smb-broker
    release: smb-volume
  - name: cf-cli-7-linux
    release: cf-cli
  lifecycle: errand
  name: smb-broker-push
  networks: cf-runtime
  stemcell: default
  vm_type: minimal
manifest_version: v16.25.0
name: compiled-windows-releases-cf
releases:
- name: binary-buildpack
  sha1: e7a659af0fdf43a73aaf95bc8bc597a8ff68f1b7
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/binary-buildpack-1.0.40-ubuntu-xenial-621.5-20210902-161851-5718983.tgz
  version: 1.0.40
- name: bpm
  sha1: b9531b0b072345aab5b02531b79c0e83d26efd82
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/bpm-1.1.14-ubuntu-xenial-621.5-20211008-005524-583637955.tgz
  version: 1.1.14
- name: capi
  sha1: e7c4adfe45d79640f9b97f8008fbe9191fd63768
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/capi-1.119.0-ubuntu-xenial-621.5-20211006-002351-607653472.tgz
  version: 1.119.0
- name: cf-networking
  sha1: 6a35883ce42039b5f96b8ba45194015815bec25f
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/cf-networking-2.39.0-ubuntu-xenial-621.5-20211007-161629-702462326.tgz
  version: 2.39.0
- name: cf-smoke-tests
  sha1: 959ba3c9324a8fbc8514dd17c9ccb1c5e9ed8eaa
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/cf-smoke-tests-41.0.2-ubuntu-xenial-621.5-20200922-004143-171268098.tgz
  version: 41.0.2
- name: cflinuxfs3
  sha1: e4ca2bd260c5fb5f453d6690c43c970c64fd88f9
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/cflinuxfs3-0.262.0-ubuntu-xenial-621.5-20211008-223403-912443494.tgz
  version: 0.262.0
- name: credhub
  sha1: f5b5ce04eee1251d352f337a6ecb794c4dba8a39
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://bosh.io/d/github.com/pivotal-cf/credhub-release?v=2.11.1
  version: 2.11.1
- name: diego
  sha1: e9e5a4bcdb41ef1b75011d9bd9ae1ace186c0510
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/diego-2.53.0-ubuntu-xenial-621.5-20210918-033819-066775025.tgz
  version: 2.53.0
- name: dotnet-core-buildpack
  sha1: 46b7b07e259a4a0c1f1c01ecb919c6a40c31343e
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/dotnet-core-buildpack-2.3.34-ubuntu-xenial-621.5-20210902-161753-439994186.tgz
  version: 2.3.34
- name: garden-runc
  sha1: 7e5e48f6a9c1cdf4ed67b320ba3e5953716251d5
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/garden-runc-1.19.30-ubuntu-xenial-621.5-20210820-171741-866896742.tgz
  version: 1.19.30
- name: go-buildpack
  sha1: 52f23d15a3eba8e687ae5f783d96dcbcf7b78f8f
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/go-buildpack-1.9.36-ubuntu-xenial-621.5-20210930-222135-495098565.tgz
  version: 1.9.36
- name: java-buildpack
  sha1: da737bdb7103e8518f270a1d1bfa2a8eba9a7a95
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/java-buildpack-4.42-ubuntu-xenial-621.5-20210921-132122-828628893.tgz
  version: "4.42"
- name: loggregator
  sha1: 835db08dbc371683716825e7e5d759c13588ca02
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/loggregator-106.6.0-ubuntu-xenial-621.5-20210511-203806-611258205.tgz
  version: 106.6.0
- name: metrics-discovery
  sha1: 18c13cb8e2ef67798b93cac4abc69cc1040d0cec
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/metrics-discovery-3.0.6-ubuntu-xenial-621.5-20210615-231306-866442869.tgz
  version: 3.0.6
- name: nats
  sha1: 3c01c52494f741905e699e524978e4d3c2c57207
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/nats-40-ubuntu-xenial-621.5-20210609-220059-858441787.tgz
  version: "40"
- name: nginx-buildpack
  sha1: 86fc554c07273042ab6d992b0387fc92c22e8d1a
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/nginx-buildpack-1.1.32-ubuntu-xenial-621.5-20210930-220617-985462983.tgz
  version: 1.1.32
- name: r-buildpack
  sha1: 6d35097f22987e2f53daea31cee3a40dbc834051
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/r-buildpack-1.1.22-ubuntu-xenial-621.5-20210930-222144-955028618.tgz
  version: 1.1.22
- name: nodejs-buildpack
  sha1: 8a142b96998ae3d54fbbe4803a3b259c3f41f532
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/nodejs-buildpack-1.7.62-ubuntu-xenial-621.5-20211001-152756-414651036.tgz
  version: 1.7.62
- name: php-buildpack
  sha1: 26e8ae63c09fbb57924bb6a7dd8da04faf556035
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/php-buildpack-4.4.46-ubuntu-xenial-621.5-20210930-211934-301931864.tgz
  version: 4.4.46
- name: pxc
  sha1: da2899f915caf4b9e73c9749b035cd9668ae8074
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/pxc-0.39.0-ubuntu-xenial-621.5-20211005-144331-171812002.tgz
  version: 0.39.0
- name: python-buildpack
  sha1: f0ae6053a7532c6c221d6f12f1c69261c0fa115c
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/python-buildpack-1.7.46-ubuntu-xenial-621.5-20210930-233522-034921645.tgz
  version: 1.7.46
- name: routing
  sha1: 84853488c7b7cebb733f2669cd07d25a45ab9d5a
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/routing-0.225.0-ubuntu-xenial-621.5-20210924-164959-996034787.tgz
  version: 0.225.0
- name: ruby-buildpack
  sha1: 0c2759f126a274ecb6d1880d636cb6825d213664
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/ruby-buildpack-1.8.47-ubuntu-xenial-621.5-20210930-224917-774866808.tgz
  version: 1.8.47
- name: silk
  sha1: 8cb1c9d93c2b3e5a1342bd9bb95e10bd089c6436
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/silk-2.39.0-ubuntu-xenial-621.5-20211007-161451-662510062.tgz
  version: 2.39.0
- name: staticfile-buildpack
  sha1: c51218ae3c353891d856800161a91d7114a954e5
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/staticfile-buildpack-1.5.25-ubuntu-xenial-621.5-20210930-203959-665426806.tgz
  version: 1.5.25
- name: statsd-injector
  sha1: 36fa23483487d5134857201f412d68b53513733c
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/statsd-injector-1.11.16-ubuntu-xenial-621.5-20210611-185755-356047559.tgz
  version: 1.11.16
- name: uaa
  sha1: 57ffc783177cbca45a983cc573b591b636d0c0bf
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://bosh.io/d/github.com/cloudfoundry/uaa-release?v=75.14.0
  version: 75.14.0
- name: loggregator-agent
  sha1: f4c33b0253f36aff880db3e619651389ce89e305
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/loggregator-agent-6.3.4-ubuntu-xenial-621.5-20210812-165634-782948492.tgz
  version: 6.3.4
- name: log-cache
  sha1: 39f889529a74b48022df1eeba2ed4aa206fc8ec3
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/log-cache-2.11.4-ubuntu-xenial-621.5-20211007-191505-317761889.tgz
  version: 2.11.4
- name: bosh-dns-aliases
  sha1: 57fb6f0a1c00ec58985b8c154586ccfd49c2abe6
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/bosh-dns-aliases-0.0.4-ubuntu-xenial-621.5-20210517-184256-782500497.tgz
  version: 0.0.4
- name: cf-cli
  sha1: d4b06254cc1633295d32bb526d66c0aadcb1b4d8
  stemcell:
    os: ubuntu-xenial
    version: "621.5"
  url: https://storage.googleapis.com/cf-deployment-compiled-releases/cf-cli-1.34.0-ubuntu-xenial-621.5-20210929-173058-494349751.tgz
  version: 1.34.0
- name: hwc-buildpack
  sha1: d23998512071991a9b85470661b77f9be3d41bc8
  url: https://bosh.io/d/github.com/cloudfoundry-incubator/hwc-buildpack-release?v=3.1.19
  version: 3.1.19
- name: winc
  sha1: 365690f87e7bea56a6eef15c92e0492165669d03
  url: https://bosh.io/d/github.com/cloudfoundry-incubator/winc-release?v=2.3.0
  version: 2.3.0
- name: windows-utilities
  sha1: 7886ffd43b84d4eced06560ba601ce1eb97c6616
  url: https://bosh.io/d/github.com/cloudfoundry-incubator/windows-utilities-release?v=0.14.0
  version: 0.14.0
- name: windowsfs
  sha1: 6de95d8762210ffe5132ac7f8ab7f9263be9468d
  url: https://bosh.io/d/github.com/cloudfoundry/windowsfs-online-release?v=2.29.0
  version: 2.29.0
- name: windows-resize-root-disk
  sha1: 8fe1adc3b6b6b68d8a370c576f649929f5452c6a
  url: https://github.com/starkandwayne/windows-resize-root-disk/releases/download/v1.0/windows-resize-root-disk-release-1.0.tgz
  version: "1.0"
- name: smb-volume
  sha1: a73587cd607cf44f8c5acf191616cdb8d4d5cda7
  url: https://bosh.io/d/github.com/cloudfoundry/smb-volume-release?v=3.1.0
  version: 3.1.0
- name: postgres
  sha1: e44bbe8f8a7cdde1cda67b202e399a239d104db6
  url: https://bosh.io/d/github.com/cloudfoundry/postgres-release?v=43
  version: "43"
stemcells:
- alias: default
  os: ubuntu-bionic
  version: "1.54"
- alias: windows2019
  os: windows2019
  version: latest
update:
  canaries: 1
  canary_watch_time: 30000-1200000
  max_in_flight: 1
  serial: false
  update_watch_time: 5000-1200000
variables: []
